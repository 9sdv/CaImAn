<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Caiman: caiman.source_extraction.cnmf.spatial Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Caiman_logo_FIsmall.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Caiman
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A Computational toolbox for large scale Calcium Imaging Analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">caiman.source_extraction.cnmf.spatial Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adbbc80bf3821229671c7f77648016071"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#adbbc80bf3821229671c7f77648016071">basis_denoising</a> (y, c, boh, sn, id2_, px)</td></tr>
<tr class="separator:adbbc80bf3821229671c7f77648016071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7b90a8cbd754f9c03b13cf1709eebd4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#ab7b90a8cbd754f9c03b13cf1709eebd4">update_spatial_components</a> (Y, <a class="el" href="to__python__format_8m.html#aaa53ca0b650dfd85c4f59fa156f7a2cc">C</a>=None, f=None, <a class="el" href="to__python__format_8m.html#ab731b667af37a5da8fba388b7a31961f">A_in</a>=None, sn=None, dims=None, min_size=3, max_size=8, dist=3, normalize_yyt_one=True, method='ellipse', expandCore=None, dview=None, n_pixels_per_process=128, medw=(3, 3), thr_method='nrg', maxthr=0.1, nrgthr=0.9999, extract_cc=True, se=np.ones((3, 3), dtype=np.int), ss=np.ones((3, 3), dtype=np.int), nb=1, method_ls='<a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#a86e3328b66dc7efa75c0646f02815ab4">nnls_L0</a>')</td></tr>
<tr class="memdesc:ab7b90a8cbd754f9c03b13cf1709eebd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">update spatial footprints and background through Basis Pursuit Denoising  <a href="#ab7b90a8cbd754f9c03b13cf1709eebd4">More...</a><br /></td></tr>
<tr class="separator:ab7b90a8cbd754f9c03b13cf1709eebd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3e32db8a5aeabf7269b756732a5e5a1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#af3e32db8a5aeabf7269b756732a5e5a1">regression_ipyparallel</a> (pars)</td></tr>
<tr class="separator:af3e32db8a5aeabf7269b756732a5e5a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0edbf4c2cd31fe1a9c228c4099a485"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#aca0edbf4c2cd31fe1a9c228c4099a485">determine_search_location</a> (A, dims, method='ellipse', min_size=3, max_size=8, dist=3, expandCore=iterate_structure(generate_binary_structure(2, 1), 2).astype(int), dview=None)</td></tr>
<tr class="memdesc:aca0edbf4c2cd31fe1a9c228c4099a485"><td class="mdescLeft">&#160;</td><td class="mdescRight">restrict search location to subset of pixels  <a href="#aca0edbf4c2cd31fe1a9c228c4099a485">More...</a><br /></td></tr>
<tr class="separator:aca0edbf4c2cd31fe1a9c228c4099a485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a940c6646b47352d714e0cfdddb3b4e65"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#a940c6646b47352d714e0cfdddb3b4e65">contruct_ellipse_parallel</a> (pars)</td></tr>
<tr class="separator:a940c6646b47352d714e0cfdddb3b4e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa5db8c88b06457233eb35dbcea3588"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#a3fa5db8c88b06457233eb35dbcea3588">threshold_components</a> (A, dims, medw=None, thr_method='nrg', maxthr=0.1, nrgthr=0.9999, extract_cc=True, se=None, ss=None, dview=None)</td></tr>
<tr class="separator:a3fa5db8c88b06457233eb35dbcea3588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1e38e003b38148972586354723e9bc4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#aa1e38e003b38148972586354723e9bc4">threshold_components_parallel</a> (pars)</td></tr>
<tr class="separator:aa1e38e003b38148972586354723e9bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e3328b66dc7efa75c0646f02815ab4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#a86e3328b66dc7efa75c0646f02815ab4">nnls_L0</a> (X, Yp, noise)</td></tr>
<tr class="separator:a86e3328b66dc7efa75c0646f02815ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f8a2090fe45b30f032bf6ec1a91c1ce"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#a6f8a2090fe45b30f032bf6ec1a91c1ce">lars_regression_noise_old</a> (Yp, X, positive, noise, verbose=False)</td></tr>
<tr class="memdesc:a6f8a2090fe45b30f032bf6ec1a91c1ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run LARS for regression problems with LASSO penalty, with optional positivity constraints.  <a href="#a6f8a2090fe45b30f032bf6ec1a91c1ce">More...</a><br /></td></tr>
<tr class="separator:a6f8a2090fe45b30f032bf6ec1a91c1ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14912eb4a48c8e566545bb4392341d04"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#a14912eb4a48c8e566545bb4392341d04">calcAvec</a> (new, dQ, W, lambda_, active_set, M, positive)</td></tr>
<tr class="separator:a14912eb4a48c8e566545bb4392341d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="adbbc80bf3821229671c7f77648016071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbbc80bf3821229671c7f77648016071">&#9670;&nbsp;</a></span>basis_denoising()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.basis_denoising </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>id2_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>px</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00050">50</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_adbbc80bf3821229671c7f77648016071_cgraph.svg" width="100%" height="450"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a14912eb4a48c8e566545bb4392341d04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14912eb4a48c8e566545bb4392341d04">&#9670;&nbsp;</a></span>calcAvec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.calcAvec </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lambda_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>active_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00960">960</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>

</div>
</div>
<a id="a940c6646b47352d714e0cfdddb3b4e65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a940c6646b47352d714e0cfdddb3b4e65">&#9670;&nbsp;</a></span>contruct_ellipse_parallel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.contruct_ellipse_parallel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pars</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00546">546</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_a940c6646b47352d714e0cfdddb3b4e65_cgraph.svg" width="379" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aca0edbf4c2cd31fe1a9c228c4099a485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca0edbf4c2cd31fe1a9c228c4099a485">&#9670;&nbsp;</a></span>determine_search_location()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.determine_search_location </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>'ellipse'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_size</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_size</em> = <code>8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dist</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expandCore</em> = <code>iterate_structure(generate_binary_structure(2,&#160;1),&#160;2).astype(int)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dview</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>restrict search location to subset of pixels </p>
<p>TODO </p>

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00461">461</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_aca0edbf4c2cd31fe1a9c228c4099a485_icgraph.svg" width="100%" height="390"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a6f8a2090fe45b30f032bf6ec1a91c1ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f8a2090fe45b30f032bf6ec1a91c1ce">&#9670;&nbsp;</a></span>lars_regression_noise_old()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.lars_regression_noise_old </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run LARS for regression problems with LASSO penalty, with optional positivity constraints. </p>
<dl class="section author"><dt>Author</dt><dd>: Andrea Giovannucci. Adapted code from Eftychios Pnevmatikakis</dd></dl>
<dl class="section user"><dt>Input Parameters</dt><dd>Yp Yp[:,t] is the observed data at time t X the regresion problem is Yp=X*W + noise maxcomps maximum number of active components to allow positive a flag to enforce positivity noise the noise of the observation equation. if it is not provided as an argument, the noise is computed from the variance at the end point of the algorithm. The noise is used in the computation of the Cp criterion.</dd></dl>
<dl class="section user"><dt>Output Parameters</dt><dd>Ws weights from each iteration lambdas lambda_ values at each iteration TODO W_lam, lam, flag Cps C_p estimates last_break last_break(m) == n means that the last break with m non-zero weights is at Ws(:,:,n) </dd></dl>

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00721">721</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_a6f8a2090fe45b30f032bf6ec1a91c1ce_icgraph.svg" width="387" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a86e3328b66dc7efa75c0646f02815ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86e3328b66dc7efa75c0646f02815ab4">&#9670;&nbsp;</a></span>nnls_L0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.nnls_L0 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>noise</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00677">677</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_a86e3328b66dc7efa75c0646f02815ab4_icgraph.svg" width="278" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af3e32db8a5aeabf7269b756732a5e5a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3e32db8a5aeabf7269b756732a5e5a1">&#9670;&nbsp;</a></span>regression_ipyparallel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.regression_ipyparallel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pars</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00348">348</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_af3e32db8a5aeabf7269b756732a5e5a1_cgraph.svg" width="391" height="198"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3fa5db8c88b06457233eb35dbcea3588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fa5db8c88b06457233eb35dbcea3588">&#9670;&nbsp;</a></span>threshold_components()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.threshold_components </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>medw</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thr_method</em> = <code>'nrg'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxthr</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nrgthr</em> = <code>0.9999</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extract_cc</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>se</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ss</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dview</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00596">596</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_a3fa5db8c88b06457233eb35dbcea3588_icgraph.svg" width="100%" height="390"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="aa1e38e003b38148972586354723e9bc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1e38e003b38148972586354723e9bc4">&#9670;&nbsp;</a></span>threshold_components_parallel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.threshold_components_parallel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pars</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00623">623</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>

</div>
</div>
<a id="ab7b90a8cbd754f9c03b13cf1709eebd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7b90a8cbd754f9c03b13cf1709eebd4">&#9670;&nbsp;</a></span>update_spatial_components()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.spatial.update_spatial_components </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>C</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A_in</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dims</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_size</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_size</em> = <code>8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dist</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normalize_yyt_one</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>'ellipse'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expandCore</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dview</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_pixels_per_process</em> = <code>128</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>medw</em> = <code>(3,&#160;3)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thr_method</em> = <code>'nrg'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxthr</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nrgthr</em> = <code>0.9999</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extract_cc</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>se</em> = <code>np.ones((3,&#160;3),&#160;dtype=np.int)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ss</em> = <code>np.ones((3,&#160;3),&#160;dtype=np.int)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nb</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method_ls</em> = <code>'<a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html#a86e3328b66dc7efa75c0646f02815ab4">nnls_L0</a>'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update spatial footprints and background through Basis Pursuit Denoising </p>
<p>for each pixel i solve the problem [A(i,:),b(i)] = argmin sum(A(i,:)) subject to || Y(i,:) - A(i,:)*C + b(i)*f || &lt;= sn(i)*sqrt(T);</p>
<p>for each pixel the search is limited to a few spatial components</p>
<h2>Parameters </h2>
<p>Y np.ndarray (2D or 3D) movie, raw data in 2D or 3D (pixels x time). C np.ndarray calcium activity of each neuron. f np.ndarray temporal profile of background activity. A_in np.ndarray spatial profile of background activity. If A_in is boolean then it defines the spatial support of A. Otherwise it is used to determine it through determine_search_location</p>
<p>dims [optional] tuple x, y[, z] movie dimensions</p>
<p>min_size [optional] int</p>
<p>max_size [optional] int</p>
<p>dist [optional] int</p>
<pre class="fragment">sn  [optional] float
    noise associated with each pixel if known

backend [optional] str
    'ipyparallel', 'single_thread'
    single_thread:no parallelization. It can be used with small datasets.
ipyparallel uses ipython clusters and then send jobs to each of them
SLURM   use the slurm scheduler

n_pixels_per_process    [optional] int
    number of pixels to be processed by each thread


method  [optional] string
    method used to expand the search for pixels 'ellipse' or 'dilate'

expandCore  [optional]  scipy.ndimage.morphology
    if method is dilate this represents the kernel used for expansion

dview   view on ipyparallel client
        you need to create an ipyparallel client and pass a view on the processors (client = Client(), dview=client[:])

medw, thr_method, maxthr, nrgthr, extract_cc, se, ss: [optional]
    Parameters for components post-processing. Refer to spatial.threshold_components for more details

nb  [optional] int
    Number of background components

method_ls:
    method to perform the regression for the basis pursuit denoising.
         'nnls_L0'. Nonnegative least square with L0 penalty
         'lasso_lars' lasso lars function from scikit learn
         'lasso_lars_old' lasso lars from old implementation, will be deprecated

normalize_yyt_one   bool
        wheter to norrmalize the C and A matrices so that diag(C*C.T) are ones

Returns
--------
A   np.ndarray
     new estimate of spatial footprints
b   np.ndarray
    new estimate of spatial background
C   np.ndarray
     temporal components (updated only when spatial components are completely removed)
f   np.ndarray
    same as f_in except if empty component deleted.</pre> 
<p class="definition">Definition at line <a class="el" href="spatial_8py_source.html#l00142">142</a> of file <a class="el" href="spatial_8py_source.html">spatial.py</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_ab7b90a8cbd754f9c03b13cf1709eebd4_cgraph.svg" width="100%" height="450"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial_ab7b90a8cbd754f9c03b13cf1709eebd4_icgraph.svg" width="547" height="99"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecaiman.html">caiman</a></li><li class="navelem"><a class="el" href="namespacecaiman_1_1source__extraction.html">source_extraction</a></li><li class="navelem"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf.html">cnmf</a></li><li class="navelem"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1spatial.html">spatial</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
