<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Caiman: caiman.source_extraction.cnmf.deconvolution Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Caiman_logo_FIsmall.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Caiman
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A Computational toolbox for large scale Calcium Imaging Analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">caiman.source_extraction.cnmf.deconvolution Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0afb63d84485a181bb40f2eefe7b581e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a0afb63d84485a181bb40f2eefe7b581e">constrained_foopsi</a> (fluor, bl=None, c1=None, g=None, sn=None, p=None, method='oasis', bas_nonneg=True, noise_range=[.25, noise_method='logmexp', lags=5, fudge_factor=1., verbosity=False, solvers=None, optimize_g=0, penalty=1, kwargs)</td></tr>
<tr class="memdesc:a0afb63d84485a181bb40f2eefe7b581e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Infer the most likely discretized spike train underlying a fluorescence trace.  <a href="#a0afb63d84485a181bb40f2eefe7b581e">More...</a><br /></td></tr>
<tr class="separator:a0afb63d84485a181bb40f2eefe7b581e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0b99f31235bd5e613cc2af56c72f102"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#ae0b99f31235bd5e613cc2af56c72f102">G_inv_mat</a> (x, mode, NT, gs, gd_vec, bas_flag=True, c1_flag=True)</td></tr>
<tr class="memdesc:ae0b99f31235bd5e613cc2af56c72f102"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast computation of G^{-1}*x and G^{-T}*x.  <a href="#ae0b99f31235bd5e613cc2af56c72f102">More...</a><br /></td></tr>
<tr class="separator:ae0b99f31235bd5e613cc2af56c72f102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04aa84702e9977187b4ac0ba95891fb6"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a04aa84702e9977187b4ac0ba95891fb6">cvxopt_foopsi</a> (fluor, b, c1, g, sn, p, bas_nonneg, verbosity)</td></tr>
<tr class="memdesc:a04aa84702e9977187b4ac0ba95891fb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the deconvolution problem using cvxopt and picos packages.  <a href="#a04aa84702e9977187b4ac0ba95891fb6">More...</a><br /></td></tr>
<tr class="separator:a04aa84702e9977187b4ac0ba95891fb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd508a8cc717626fa4c45d0a5c08bfd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a0dd508a8cc717626fa4c45d0a5c08bfd">cvxpy_foopsi</a> (fluor, g, sn, b=None, c1=None, bas_nonneg=True, solvers=None)</td></tr>
<tr class="memdesc:a0dd508a8cc717626fa4c45d0a5c08bfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the deconvolution problem using the cvxpy package and the ECOS/SCS library.  <a href="#a0dd508a8cc717626fa4c45d0a5c08bfd">More...</a><br /></td></tr>
<tr class="separator:a0dd508a8cc717626fa4c45d0a5c08bfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9f9b2ef0aad5c652f86bd8c7ae64bdd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#ad9f9b2ef0aad5c652f86bd8c7ae64bdd">_nnls</a> (KK, Ky, s=None, mask=None, tol=1e-9, max_iter=None)</td></tr>
<tr class="separator:ad9f9b2ef0aad5c652f86bd8c7ae64bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affae481e26d5e13bc6f62c6e643b63d5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#affae481e26d5e13bc6f62c6e643b63d5">onnls</a> (y, g, lam=0, shift=100, window=None, mask=None, tol=1e-9, max_iter=None)</td></tr>
<tr class="memdesc:affae481e26d5e13bc6f62c6e643b63d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Infer the most likely discretized spike train underlying an AR(2) fluorescence trace.  <a href="#affae481e26d5e13bc6f62c6e643b63d5">More...</a><br /></td></tr>
<tr class="separator:affae481e26d5e13bc6f62c6e643b63d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5753e123f06d6f8a5f53e8f1cc50baba"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a5753e123f06d6f8a5f53e8f1cc50baba">constrained_oasisAR2</a> (y, g, sn, optimize_b=True, b_nonneg=True, optimize_g=0, decimate=5, shift=100, window=None, tol=1e-9, max_iter=1, penalty=1)</td></tr>
<tr class="memdesc:a5753e123f06d6f8a5f53e8f1cc50baba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Infer the most likely discretized spike train underlying an AR(2) fluorescence trace.  <a href="#a5753e123f06d6f8a5f53e8f1cc50baba">More...</a><br /></td></tr>
<tr class="separator:a5753e123f06d6f8a5f53e8f1cc50baba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7199190b4f33e4a70dedc9deea7e4c45"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a7199190b4f33e4a70dedc9deea7e4c45">estimate_parameters</a> (fluor, p=2, sn=None, g=None, range_ff=[0.25, method='logmexp', lags=5, fudge_factor=1.)</td></tr>
<tr class="separator:a7199190b4f33e4a70dedc9deea7e4c45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a73db2b3e0e88f4a5f30f80944c1319"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a7a73db2b3e0e88f4a5f30f80944c1319">estimate_time_constant</a> (fluor, p=2, sn=None, lags=5, fudge_factor=1.)</td></tr>
<tr class="separator:a7a73db2b3e0e88f4a5f30f80944c1319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16b9a254776edd0d9093ee35b1ef17a2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a16b9a254776edd0d9093ee35b1ef17a2">GetSn</a> (fluor, range_ff=[0.25, method='logmexp')</td></tr>
<tr class="separator:a16b9a254776edd0d9093ee35b1ef17a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a458da977dee6e97910a1b006e899b309"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a458da977dee6e97910a1b006e899b309">axcov</a> (data, maxlag=5)</td></tr>
<tr class="separator:a458da977dee6e97910a1b006e899b309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d83696f273bd0121651cf48a6b899ae"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html#a8d83696f273bd0121651cf48a6b899ae">nextpow2</a> (value)</td></tr>
<tr class="separator:a8d83696f273bd0121651cf48a6b899ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad9f9b2ef0aad5c652f86bd8c7ae64bdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9f9b2ef0aad5c652f86bd8c7ae64bdd">&#9670;&nbsp;</a></span>_nnls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution._nnls </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>KK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Ky</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00431">431</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_ad9f9b2ef0aad5c652f86bd8c7ae64bdd_icgraph.svg" width="1222" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a458da977dee6e97910a1b006e899b309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a458da977dee6e97910a1b006e899b309">&#9670;&nbsp;</a></span>axcov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.axcov </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxlag</em> = <code>5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00959">959</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a458da977dee6e97910a1b006e899b309_cgraph.svg" width="198" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a458da977dee6e97910a1b006e899b309_icgraph.svg" width="1531" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0afb63d84485a181bb40f2eefe7b581e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0afb63d84485a181bb40f2eefe7b581e">&#9670;&nbsp;</a></span>constrained_foopsi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.constrained_foopsi </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fluor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bl</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c1</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>'oasis'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bas_nonneg</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>noise_range</em> = <code>[.25</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>noise_method</em> = <code>'logmexp'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lags</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fudge_factor</em> = <code>1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbosity</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>solvers</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>optimize_g</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>penalty</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Infer the most likely discretized spike train underlying a fluorescence trace. </p>
<p>It relies on a noise constrained deconvolution approach</p>
<pre class="fragment">Parameters
----------
fluor   np.ndarray
    One dimensional array containing the fluorescence intensities with
    one entry per time-bin.
bl  [optional] float
    Fluorescence baseline value. If no value is given, then bl is estimated
    from the data.
c1  [optional] float
    value of calcium at time 0
g   [optional] list,float
    Parameters of the AR process that models the fluorescence impulse response.
    Estimated from the data if no value is given
sn  float, optional
    Standard deviation of the noise distribution.  If no value is given,
    then sn is estimated from the data.
p   int
    order of the autoregression model
method  [optional] string
    solution method for basis projection pursuit 'cvx' or 'cvxpy' or 'oasis'
bas_nonneg  bool
    baseline strictly non-negative
noise_range list of two elms
    frequency range for averaging noise PSD
noise_method    string
    method of averaging noise PSD
lags    int
    number of lags for estimating time constants
fudge_factor    float
    fudge factor for reducing time constant bias
verbosity   bool
     display optimization details
solvers list string
    primary and secondary (if problem unfeasible for approx solution) solvers
    to be used with cvxpy, default is ['ECOS','SCS']
optimize_g  [optional] int, only applies to method 'oasis'
    Number of large, isolated events to consider for optimizing g.
    If optimize_g=0 (default) the provided or estimated g is not further optimized.
penalty [optional] int, default 1, only applies to method 'oasis'
    Sparsity penalty. 1: min |s|_1  0: min |s|_0

Returns
-------
c   np.ndarray float
    The inferred denoised fluorescence signal at each time-bin.
bl, c1, g, sn : As explained above
sp  ndarray of float
    Discretized deconvolved neural activity (spikes)

References
----------
* Pnevmatikakis et al. 2016. Neuron, in press, http://dx.doi.org/10.1016/j.neuron.2015.11.037
* Machado et al. 2015. Cell 162(2):338-350</pre> 
<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00083">83</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a0afb63d84485a181bb40f2eefe7b581e_cgraph.svg" width="992" height="159"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a0afb63d84485a181bb40f2eefe7b581e_icgraph.svg" width="814" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a5753e123f06d6f8a5f53e8f1cc50baba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5753e123f06d6f8a5f53e8f1cc50baba">&#9670;&nbsp;</a></span>constrained_oasisAR2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.constrained_oasisAR2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>optimize_b</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b_nonneg</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>optimize_g</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>decimate</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shift</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>window</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>penalty</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Infer the most likely discretized spike train underlying an AR(2) fluorescence trace. </p>
<p>Solves the noise constrained sparse non-negative deconvolution problem min |s|_1 subject to |c-y|^2 = sn^2 T and s_t = c_t-g1 c_{t-1}-g2 c_{t-2} &gt;= 0</p>
<h2>Parameters </h2>
<p>y array of float One dimensional array containing the fluorescence intensities (with baseline already subtracted) with one entry per time-bin. g (float, float) Parameters of the AR(2) process that models the fluorescence impulse response. sn float Standard deviation of the noise distribution. optimize_b bool, optional, default True Optimize baseline if True else it is set to 0, see y. b_nonneg bool, optional, default True Enforce strictly non-negative baseline if True. optimize_g int, optional, default 0 Number of large, isolated events to consider for optimizing g. No optimization if optimize_g=0. decimate int, optional, default 5 Decimation factor for estimating hyper-parameters faster on decimated data. shift int, optional, default 100 Number of frames by which to shift window from on run of NNLS to the next. window int, optional, default <a class="el" href="namespace_none.html" title="create a groundtruth for different videos ">None</a> (200 or larger dependend on g) Window size. tol float, optional, default 1e-9 Tolerance parameter. max_iter int, optional, default 1 Maximal number of iterations. penalty int, optional, default 1 Sparsity penalty. 1: min |s|_1 0: min |s|_0</p>
<h2>Returns </h2>
<p>c array of float The inferred denoised fluorescence signal at each time-bin. s array of float Discretized deconvolved neural activity (spikes). b float Fluorescence baseline value. (g1, g2) : tuple of float Parameters of the AR(2) process that models the fluorescence impulse response. lam float Sparsity penalty parameter lambda of dual problem.</p>
<h2>References </h2>
<ul>
<li>Friedrich J and Paninski L, NIPS 2016</li>
<li>Friedrich J, Zhou P, and Paninski L, arXiv 2016 </li>
</ul>

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00634">634</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a5753e123f06d6f8a5f53e8f1cc50baba_cgraph.svg" width="811" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a5753e123f06d6f8a5f53e8f1cc50baba_icgraph.svg" width="1019" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a04aa84702e9977187b4ac0ba95891fb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04aa84702e9977187b4ac0ba95891fb6">&#9670;&nbsp;</a></span>cvxopt_foopsi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.cvxopt_foopsi </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fluor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bas_nonneg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the deconvolution problem using cvxopt and picos packages. </p>

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00161">161</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a04aa84702e9977187b4ac0ba95891fb6_icgraph.svg" width="966" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0dd508a8cc717626fa4c45d0a5c08bfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd508a8cc717626fa4c45d0a5c08bfd">&#9670;&nbsp;</a></span>cvxpy_foopsi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.cvxpy_foopsi </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fluor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c1</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bas_nonneg</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>solvers</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the deconvolution problem using the cvxpy package and the ECOS/SCS library. </p>
<h2>Parameters </h2>
<p>fluor ndarray fluorescence trace g list of doubles parameters of the autoregressive model, cardinality equivalent to p sn double estimated noise level b double baseline level. If <a class="el" href="namespace_none.html" title="create a groundtruth for different videos ">None</a> it is estimated. c1 double initial value of calcium. If <a class="el" href="namespace_none.html" title="create a groundtruth for different videos ">None</a> it is estimated. bas_nonneg boolean should the baseline be estimated solvers tuple of two strings primary and secondary solvers to be used. Can be choosen between ECOS, SCS, CVXOPT</p>
<h2></h2>
<dl class="section return"><dt>Returns</dt><dd>c estimated calcium trace </dd>
<dd>
b estimated baseline </dd>
<dd>
c1 esimtated initial calcium value </dd>
<dd>
g esitmated parameters of the autoregressive model </dd>
<dd>
sn estimated noise level </dd>
<dd>
sp estimated spikes </dd></dl>

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00296">296</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a0dd508a8cc717626fa4c45d0a5c08bfd_icgraph.svg" width="960" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7199190b4f33e4a70dedc9deea7e4c45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7199190b4f33e4a70dedc9deea7e4c45">&#9670;&nbsp;</a></span>estimate_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.estimate_parameters </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fluor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>range_ff</em> = <code>[0.25</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>'logmexp'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lags</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fudge_factor</em> = <code>1.</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00857">857</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a7199190b4f33e4a70dedc9deea7e4c45_cgraph.svg" width="606" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a7199190b4f33e4a70dedc9deea7e4c45_icgraph.svg" width="1214" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7a73db2b3e0e88f4a5f30f80944c1319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a73db2b3e0e88f4a5f30f80944c1319">&#9670;&nbsp;</a></span>estimate_time_constant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.estimate_time_constant </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fluor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lags</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fudge_factor</em> = <code>1.</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00891">891</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a7a73db2b3e0e88f4a5f30f80944c1319_cgraph.svg" width="411" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a7a73db2b3e0e88f4a5f30f80944c1319_icgraph.svg" width="1424" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae0b99f31235bd5e613cc2af56c72f102"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0b99f31235bd5e613cc2af56c72f102">&#9670;&nbsp;</a></span>G_inv_mat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.G_inv_mat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>NT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gd_vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bas_flag</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c1_flag</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fast computation of G^{-1}*x and G^{-T}*x. </p>

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00145">145</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>

</div>
</div>
<a id="a16b9a254776edd0d9093ee35b1ef17a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16b9a254776edd0d9093ee35b1ef17a2">&#9670;&nbsp;</a></span>GetSn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.GetSn </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fluor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>range_ff</em> = <code>[0.25</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>'logmexp'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00930">930</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a16b9a254776edd0d9093ee35b1ef17a2_icgraph.svg" width="1534" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8d83696f273bd0121651cf48a6b899ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d83696f273bd0121651cf48a6b899ae">&#9670;&nbsp;</a></span>nextpow2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.nextpow2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00981">981</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_a8d83696f273bd0121651cf48a6b899ae_icgraph.svg" width="1659" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="affae481e26d5e13bc6f62c6e643b63d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affae481e26d5e13bc6f62c6e643b63d5">&#9670;&nbsp;</a></span>onnls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.deconvolution.onnls </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lam</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shift</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>window</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Infer the most likely discretized spike train underlying an AR(2) fluorescence trace. </p>
<p>Solves the sparse non-negative deconvolution problem <code>argmin_s 1/2|Ks-y|^2 + lam |s|_1</code> for <code>s&gt;=0</code></p>
<h2>Parameters </h2>
<p>y array of float, shape (T,) One dimensional array containing the fluorescence intensities with one entry per time-bin. g array, shape (p,) if p in (1,2): Parameter(s) of the AR(p) process that models the fluorescence impulse response. else: Kernel that models the fluorescence impulse response. lam float, optional, default 0 Sparsity penalty parameter lambda. shift int, optional, default 100 Number of frames by which to shift window from on run of NNLS to the next. window int, optional, default <a class="el" href="namespace_none.html" title="create a groundtruth for different videos ">None</a> (200 or larger dependend on g) Window size. mask array of bool, shape (n,), optional, default (True,)*n Mask to restrict potential spike times considered. tol float, optional, default 1e-9 Tolerance parameter. max_iter <a class="el" href="namespace_none.html" title="create a groundtruth for different videos ">None</a> or int, optional, default <a class="el" href="namespace_none.html" title="create a groundtruth for different videos ">None</a> Maximum number of iterations before termination. If <a class="el" href="namespace_none.html" title="create a groundtruth for different videos ">None</a> (default), it is set to window size.</p>
<h2>Returns </h2>
<p>c array of float, shape (T,) The inferred denoised fluorescence signal at each time-bin. s array of float, shape (T,) Discretized deconvolved neural activity (spikes).</p>
<h2>References </h2>
<ul>
<li>Friedrich J and Paninski L, NIPS 2016</li>
<li>Bro R and DeJong S, J Chemometrics 1997 </li>
</ul>

<p class="definition">Definition at line <a class="el" href="deconvolution_8py_source.html#l00516">516</a> of file <a class="el" href="deconvolution_8py_source.html">deconvolution.py</a>.</p>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_affae481e26d5e13bc6f62c6e643b63d5_cgraph.svg" width="912" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution_affae481e26d5e13bc6f62c6e643b63d5_icgraph.svg" width="1120" height="175"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecaiman.html">caiman</a></li><li class="navelem"><a class="el" href="namespacecaiman_1_1source__extraction.html">source_extraction</a></li><li class="navelem"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf.html">cnmf</a></li><li class="navelem"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1deconvolution.html">deconvolution</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
